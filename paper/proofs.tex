\section{Proofs}
\label{sec:proofs}

In this section we prove all theorems we have stated.
We first observe that the non-interference claims for the languages
|specLang seqf targetLang| and |specLang roundrobinf targetLang|
in Theorems~\ref{thm:rr-tsni} and~\ref{thm:seq-tini} follow directly
from Theorems~\ref{thm:iso-tsni} and~\ref{thm:iso-tini},
respectively, where the set
of predicates is the set of always valid predicates (i.e., no restriction).

Before we proceed with the proof of Theorem~\ref{thm:iso-tsni},
we state a lemma we will use.

\begin{lemma}
  \label{lemma:rr-tsni-general}
  We consider, for any target language |targetLang|,
  the restricted IFC language |restrictedLang alpha targetLang|
  (according to Definition~\ref{def:restricted}).
  Then,
  for any configurations |ic1|, |ic1'|, |ic2|, and label |il| where
  \begin{equation} \label{eq:tsni-lemma-lhs}
  |ic1| \approx_{|il|} |ic2|
  \qquad \text{and} \qquad
  |ic1| |.->| |ic1'|
  \end{equation}
  there exists a configuration |ic2'| such that
  \begin{equation} \label{eq:tsni-lemma-rhs}
  |ic1'| \approx_{|il|} |ic2'|
  \qquad \text{and} \qquad
  |ic2| |.->|^* |ic2'|
  \ \text{.}
  \end{equation}
\end{lemma}

\begin{proof}[Proof of Theorem~\ref{thm:iso-tsni}]
  We proof the theorem by induction on the length of the derivation sequence in~\eqref{eq:tsni-lhs}.
  The base case for derivations
  of length 0 is trivial, allowing
  us to simple chose $|ic2'=ic2|$.  In the step case,
  we split the derivation sequence from~\eqref{eq:tsni-lhs} of length $n+1$ as follows:
  \[
  |ic1| |.->| |ic1''| |.->|^n |ic1'|
  \]
  for some configuration |ic1''|.  By Lemma~\ref{lemma:rr-tsni-general} to
  the first step and
  the induction hypothesis to the rest of the derivation sequence,
  we directly get the desired property.
  % long version
%  We proof the theorem by induction on the length of the derivation sequence in~\eqref{eq:tsni-lhs}.
%  The base case for derivations
%  of length 0 is trivial, allowing
%  us to simple chose $|ic2'=ic2|$.  In the step case, we assume
%  the theorem holds for derivation sequences of length up to $n$, and show that it also
%  holds for those of length $n+1$.  We split the derivation sequence from~\eqref{eq:tsni-lhs} as follows:
%  \[
%  |ic1| |.->| |ic1''| |.->|^n |ic1'|
%  \]
%  for some configuration |ic1''|.  By Lemma~\ref{lemma:rr-tsni-general}, we get
%  |ic''| with
%  \begin{equation} \label{eq:tsni-proof-1}
%  |ic1''| \approx_{|il|} |ic2''|
%  \qquad \text{and} \qquad
%  |ic2| |.->|^* |ic2''|
%  \end{equation}
%  Applying the induction hypothesis to
%  $|ic1''| |.->|^n |ic1'|$, we get |ic2'| with
%  \begin{equation} \label{eq:tsni-proof-2}
%  |ic1'| \approx_{|il|} |ic2'|
%  \qquad \text{and} \qquad
%  |ic2''| |.->|^* |ic2'|
%  \end{equation}
%  Stitching together the derivation sequences from~\eqref{eq:tsni-proof-1} and~\eqref{eq:tsni-proof-2} directly gives
%  us the right-hand side of the implication in the TSNI
%  definition~\eqref{eq:tsni-rhs}, which concludes the proof.
\end{proof}
\begin{proof}[Proof sketch of Lemma~\ref{lemma:rr-tsni-general}]
  For space reasons, we only sketch the structure of the proof here.
  We refer the interested reader to the Appendix for a full proof.
  The proof distinguishes two cases:
  \begin{itemize}
    \item If the task |it1| executed in |ic1| is erased, then there is no
    need to take a step in |ic2|, as the computation in |ic1| does
    not have any visible effects after erasure.
    \item Otherwise, there must be a corresponding task |it2| in |ic2|, and
    it can take exactly the same reduction step as the task in |ic1|.
    The only difficulty is that there might be secret tasks executing
    before |it2|, but it can be shown that these do not influence the
    computation after erasure.
  \end{itemize}
\end{proof}
The proof of Theorem~\ref{thm:iso-tini} about TINI proceeds largely
in the same fashion as for Theorem~\ref{thm:iso-tsni} (TSNI), except that
some cases are simpler due to the fact termination is not an issue
(cf.~\cite{lio} for a TINI proof of a similar system).
